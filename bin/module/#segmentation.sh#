#!/usr/bin/env bash

dsb=$1			# this is the full path to the DSB data bed file *UMI_count*
resolution=$2			# resolution of the binned genome

#create bed files representing the binned genome
~/Work/pipelines/aux.scripts/make-windows.sh $resolution hg19 > A.bed


#############################################################
# prepare the mean descriptor
if [ "$mean" == "xz30" ]; then
    cat ~/Work/dataset/restseq/xz30/outdata/*_*_*.bed | 
    LC_ALL=C sort -k1,1 -k2,2n | 
    LC_ALL=C uniq -c |
    awk -v OFS='\t' '{print $2,$3,$3+1,$1}' > ~/Work/dataset/restseq/loc_count_MeanDescriptor.bed
    #count the number of molecules in each bin
    bedtools intersect -a A.bed -b ~/Work/dataset/restseq/loc_count_MeanDescriptor.bed -c > ~/Work/dataset/restseq/binned_raw_MeanDescriptor.bed
    cat ~/Work/dataset/restseq/binned_raw_MeanDescriptor.bed | cut -f4 > ~/Work/dataset/restseq/p
fi
